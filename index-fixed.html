<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VGMEDIA - N·ªÅn t·∫£ng nh·∫°c DJ Remix</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@800;900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="./assets/images/favicon.ico">
    <meta name="description" content="VGMEDIA - N·ªÅn t·∫£ng nh·∫°c DJ Remix ch·∫•t l∆∞·ª£ng cao. Nghe v√† t·∫£i nh·∫°c mi·ªÖn ph√≠, premium.">
    <meta name="keywords" content="nh·∫°c DJ, remix, VGMEDIA, nh·∫°c ƒëi·ªán t·ª≠, EDM">
    <meta property="og:title" content="VGMEDIA - Nh·∫°c DJ Remix">
    <meta property="og:description" content="Nghe nh·∫°c DJ Remix ch·∫•t l∆∞·ª£ng cao">
    <meta property="og:image" content="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80">
    <meta property="og:url" content="https://saninja547-byte.github.io/vgmedia-website/">
    <style>
        /* Additional styles for enhanced features */
        .trending-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(135deg, #FF6584, #FF3366);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            z-index: 2;
        }
        
        .song-item {
            position: relative;
        }
        
        .play-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(108, 99, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: var(--radius-md);
            z-index: 1;
        }
        
        .song-item:hover .play-overlay {
            opacity: 1;
        }
        
        .play-overlay i {
            font-size: 2rem;
            color: white;
        }
        
        .stats-bar {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--gray-light);
        }
        
        .stat-item i {
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .stat-value {
            font-weight: 700;
            color: var(--light);
            font-size: 1.1rem;
        }
        
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .quick-action-btn {
            padding: 8px 15px;
            background: var(--dark-lighter);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-md);
            color: var(--gray-light);
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quick-action-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .user-stats {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-left: auto;
        }
        
        .user-stat {
            text-align: center;
        }
        
        .user-stat-value {
            font-weight: 700;
            color: var(--light);
            font-size: 1.2rem;
        }
        
        .user-stat-label {
            font-size: 0.8rem;
            color: var(--gray);
        }
        
        /* Loading animation */
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .loading {
            animation: pulse 1.5s infinite;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <span class="logo-icon">üéµ</span>
                    <h1 class="logo-text">VG<span class="logo-highlight">MEDIA</span></h1>
                </div>
                
                <div class="nav-links">
                    <a href="#" class="nav-link active" onclick="showSection('player')"><i class="fas fa-home"></i> Trang ch·ªß</a>
                    <a href="#library" class="nav-link" onclick="showSection('library')"><i class="fas fa-music"></i> Th∆∞ vi·ªán</a>
                    <a href="#trending" class="nav-link" onclick="showSection('trending')"><i class="fas fa-fire"></i> Trending</a>
                    <a href="./admin.html" class="nav-link" id="adminLink" style="display: none;"><i class="fas fa-cog"></i> Qu·∫£n l√Ω</a>
                </div>
                
                <div class="nav-actions">
                    <button class="btn-subscribe" id="subscribeBtn">
                        <i class="fas fa-crown"></i> N√¢ng c·∫•p Premium
                    </button>
                    <div class="user-menu" id="userMenu" style="display: none;">
                        <div class="user-stats">
                            <div class="user-stat">
                                <div class="user-stat-value" id="songCount">0</div>
                                <div class="user-stat-label">B√†i h√°t</div>
                            </div>
                            <div class="user-stat">
                                <div class="user-stat-value" id="favoriteCount">0</div>
                                <div class="user-stat-label">Y√™u th√≠ch</div>
                            </div>
                        </div>
                        <span id="userName">Kh√°ch</span>
                        <button id="logoutBtn" title="ƒêƒÉng xu·∫•t">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                    <button class="btn-login" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> ƒêƒÉng nh·∫≠p
                    </button>
                </div>
                
                <button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- Player Section -->
    <main class="main-content">
        <div class="container player-container">
            <!-- Player Card -->
            <div class="player-card" id="playerSection">
                <!-- Waveform Visualization -->
                <div class="waveform-container">
                    <canvas id="waveformCanvas"></canvas>
                    <div class="vinyl-record">
                        <div class="vinyl">
                            <div class="vinyl-inner">
                                <div class="vinyl-center"></div>
                            </div>
                        </div>
                        <div class="vinyl-shadow"></div>
                    </div>
                </div>
                
                <!-- Stats Bar -->
                <div class="stats-bar">
                    <div class="stat-item">
                        <i class="fas fa-headphones"></i>
                        <div>
                            <div class="stat-value" id="totalPlays">1,234</div>
                            <div>L∆∞·ª£t nghe</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-heart"></i>
                        <div>
                            <div class="stat-value" id="totalLikes">567</div>
                            <div>Y√™u th√≠ch</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-download"></i>
                        <div>
                            <div class="stat-value" id="totalDownloads">89</div>
                            <div>T·∫£i xu·ªëng</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-users"></i>
                        <div>
                            <div class="stat-value" id="onlineUsers">42</div>
                            <div>ƒêang online</div>
                        </div>
                    </div>
                </div>
                
                <!-- Song Info -->
                <div class="song-info">
                    <div class="song-thumbnail">
                        <img id="currentThumbnail" src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80" alt="Song Thumbnail">
                        <div class="song-badge premium" id="currentBadge">PREMIUM</div>
                    </div>
                    
                    <div class="song-details">
                        <h2 class="song-title" id="currentTitle">Ch√†o m·ª´ng ƒë·∫øn VGMEDIA</h2>
                        <p class="song-artist" id="currentArtist">H·ªá th·ªëng nh·∫°c ch·∫•t l∆∞·ª£ng cao</p>
                        <div class="song-meta">
                            <span class="song-duration" id="currentDuration"><i class="fas fa-clock"></i> 0:00</span>
                            <span class="song-genre" id="currentGenre"><i class="fas fa-tag"></i> EDM</span>
                            <span class="song-bpm" id="currentBPM"><i class="fas fa-tachometer-alt"></i> 128 BPM</span>
                        </div>
                        <p class="song-description" id="currentDescription">
                            VGMEDIA - N·ªÅn t·∫£ng nh·∫°c DJ Remix ch·∫•t l∆∞·ª£ng cao nh·∫•t Vi·ªát Nam.
                            <br><span id="introNotice" style="color: #FF6584; font-weight: 600; display: none;">
                            <i class="fas fa-headphones"></i> ƒê∆∞·ª£c nghe th·ª≠ 2:30 ph√∫t ƒë·∫ßu</span>
                        </p>
                        
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <button class="quick-action-btn" onclick="shareSong()">
                                <i class="fas fa-share"></i> Chia s·∫ª
                            </button>
                            <button class="quick-action-btn" onclick="addToPlaylist()">
                                <i class="fas fa-list"></i> Th√™m v√†o playlist
                            </button>
                            <button class="quick-action-btn" onclick="viewLyrics()">
                                <i class="fas fa-file-alt"></i> L·ªùi b√†i h√°t
                            </button>
                        </div>
                        
                        <div class="song-actions">
                            <button class="btn-action btn-play" id="playBtn">
                                <i class="fas fa-play"></i> Ph√°t nh·∫°c
                            </button>
                            <button class="btn-action btn-pause" id="pauseBtn" style="display: none;">
                                <i class="fas fa-pause"></i> T·∫°m d·ª´ng
                            </button>
                            <button class="btn-action btn-like" id="likeBtn">
                                <i class="far fa-heart"></i> Y√™u th√≠ch
                            </button>
                            <button class="btn-action btn-download" id="downloadBtn">
                                <i class="fas fa-download"></i> T·∫£i xu·ªëng
                            </button>
                            <button class="btn-action btn-buy" id="buyBtn">
                                <i class="fas fa-shopping-cart"></i> Mua b√†i h√°t
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Player Controls -->
                <div class="player-controls">
                    <div class="progress-container">
                        <div class="progress-time current-time" id="currentTime">00:00</div>
                        <div class="progress-bar" id="progressBar">
                            <div class="progress" id="songProgress"></div>
                            <div class="progress-handle" id="progressHandle"></div>
                        </div>
                        <div class="progress-time total-time" id="totalTime">0:00</div>
                    </div>
                    
                    <div class="control-buttons">
                        <button class="control-btn" id="prevBtn">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button class="control-btn btn-play-main" id="playMainBtn">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="control-btn" id="nextBtn">
                            <i class="fas fa-step-forward"></i>
                        </button>
                        
                        <div class="volume-control">
                            <i class="fas fa-volume-up volume-icon"></i>
                            <input type="range" min="0" max="100" value="80" class="volume-slider" id="volumeSlider">
                        </div>
                        
                        <button class="control-btn" id="repeatBtn">
                            <i class="fas fa-redo"></i>
                        </button>
                        <button class="control-btn" id="shuffleBtn">
                            <i class="fas fa-random"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Music Library -->
            <div class="music-library" id="librarySection">
                <div class="library-header">
                    <h3><i class="fas fa-music"></i> Th∆∞ vi·ªán nh·∫°c VGMEDIA</h3>
                    <div class="library-filters">
                        <button class="filter-btn active" data-filter="all" onclick="filterSongs('all')">T·∫•t c·∫£</button>
                        <button class="filter-btn" data-filter="free" onclick="filterSongs('free')">Mi·ªÖn ph√≠</button>
                        <button class="filter-btn" data-filter="premium" onclick="filterSongs('premium')">Premium</button>
                        <button class="filter-btn" data-filter="favorites" onclick="filterSongs('favorites')">
                            <i class="fas fa-heart"></i> Y√™u th√≠ch
                        </button>
                    </div>
                </div>
                
                <div class="songs-list" id="songsList">
                    <!-- Songs loaded by JavaScript -->
                    <div class="loading-placeholder" style="text-align: center; padding: 40px; color: #8A8A8A; grid-column: 1 / -1;">
                        <i class="fas fa-spinner fa-spin loading" style="font-size: 2rem; margin-bottom: 20px;"></i>
                        <p>ƒêang t·∫£i th∆∞ vi·ªán nh·∫°c...</p>
                    </div>
                </div>
            </div>
            
            <!-- Trending Now -->
            <div class="music-library" id="trendingSection">
                <div class="library-header">
                    <h3><i class="fas fa-fire"></i> Trending Now - Top b√†i h√°t</h3>
                    <div class="library-filters">
                        <button class="filter-btn active" onclick="showTrending('daily')">H√¥m nay</button>
                        <button class="filter-btn" onclick="showTrending('weekly')">Tu·∫ßn n√†y</button>
                        <button class="filter-btn" onclick="showTrending('monthly')">Th√°ng n√†y</button>
                        <button class="filter-btn" onclick="showTrending('alltime')">M·ªçi th·ªùi ƒë·∫°i</button>
                    </div>
                </div>
                
                <div class="songs-list" id="trendingSongs">
                    <!-- Trending songs loaded by JavaScript -->
                    <div class="loading-placeholder" style="text-align: center; padding: 40px; color: #8A8A8A; grid-column: 1 / -1;">
                        <i class="fas fa-spinner fa-spin loading" style="font-size: 2rem; margin-bottom: 20px;"></i>
                        <p>ƒêang t·∫£i trending...</p>
                    </div>
                </div>
            </div>
            
            <!-- New Releases -->
            <div class="music-library" id="newReleasesSection" style="display: none;">
                <div class="library-header">
                    <h3><i class="fas fa-star"></i> B√†i h√°t m·ªõi</h3>
                    <div class="library-filters">
                        <button class="filter-btn active" onclick="showNewReleases('week')">Tu·∫ßn n√†y</button>
                        <button class="filter-btn" onclick="showNewReleases('month')">Th√°ng n√†y</button>
                    </div>
                </div>
                
                <div class="songs-list" id="newReleasesSongs">
                    <!-- New releases loaded by JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2>VG<span>MEDIA</span></h2>
                    <p>N·ªÅn t·∫£ng nh·∫°c ch·∫•t l∆∞·ª£ng cao h√†ng ƒë·∫ßu Vi·ªát Nam</p>
                    <div class="app-stats" style="margin-top: 20px;">
                        <div style="display: flex; gap: 20px;">
                            <div>
                                <div class="stat-value">1,000+</div>
                                <div class="user-stat-label">B√†i h√°t</div>
                            </div>
                            <div>
                                <div class="stat-value">50,000+</div>
                                <div class="user-stat-label">Ng∆∞·ªùi d√πng</div>
                            </div>
                            <div>
                                <div class="stat-value">1M+</div>
                                <div class="user-stat-label">L∆∞·ª£t nghe</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>Kh√°m ph√°</h4>
                        <a href="#" onclick="showSection('trending')">Trending</a>
                        <a href="#" onclick="showSection('library')">Th∆∞ vi·ªán nh·∫°c</a>
                        <a href="#" onclick="showNewReleases('week')">B√†i h√°t m·ªõi</a>
                        <a href="#" onclick="filterSongs('favorites')">Y√™u th√≠ch</a>
                    </div>
                    
                    <div class="footer-column">
                        <h4>T√†i kho·∫£n</h4>
                        <a href="./login.html" id="footerLogin">ƒêƒÉng nh·∫≠p</a>
                        <a href="./login.html" id="footerRegister">ƒêƒÉng k√Ω</a>
                        <a href="#" onclick="showUpgradeModal()" id="footerPremium">N√¢ng c·∫•p Premium</a>
                        <a href="#" onclick="showHelp()">H·ªó tr·ª£</a>
                    </div>
                    
                    <div class="footer-column">
                        <h4>VGMEDIA</h4>
                        <a href="#" onclick="showAbout()">V·ªÅ ch√∫ng t√¥i</a>
                        <a href="#" onclick="showTerms()">ƒêi·ªÅu kho·∫£n</a>
                        <a href="#" onclick="showPrivacy()">B·∫£o m·∫≠t</a>
                        <a href="#" onclick="showContact()">Li√™n h·ªá</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 VGMEDIA. All rights reserved. <span id="currentYear"></span></p>
                <div class="social-links">
                    <a href="#" title="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" title="YouTube"><i class="fab fa-youtube"></i></a>
                    <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" title="TikTok"><i class="fab fa-tiktok"></i></a>
                    <a href="#" title="Discord"><i class="fab fa-discord"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Audio Element -->
    <audio id="audioPlayer" preload="metadata">
        <!-- Audio source will be set dynamically -->
    </audio>

    <!-- JavaScript -->
    <script src="./js/music-data.js"></script>
    <script src="./js/auth-fixed.js"></script>
    <script src="./js/app-fixed.js"></script>
    
    <!-- Enhanced Features Script -->
    <script>
        // Enhanced features for VGMEDIA
        console.log('üéµ VGMEDIA Enhanced Features Loading...');
        
        // Global variables
        let currentSongId = null;
        let currentSection = 'player';
        let trendingData = {
            daily: [],
            weekly: [],
            monthly: [],
            alltime: []
        };
        
        // Initialize enhanced features
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing enhanced features...');
            
            // Update current year
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Setup section switching
            setupSectionSwitching();
            
            // Load trending data
            loadTrendingData();
            
            // Update user stats
            updateUserStats();
            
            // Setup enhanced event listeners
            setupEnhancedListeners();
            
            // Setup mobile menu
            setupMobileMenu();
            
            console.log('‚úÖ Enhanced features ready!');
        });
        
        // Section switching
        function setupSectionSwitching() {
            const sections = ['player', 'library', 'trending'];
            
            sections.forEach(section => {
                const links = document.querySelectorAll(`[onclick*="${section}"]`);
                links.forEach(link => {
                    link.addEventListener('click', function(e) {
                        if (this.getAttribute('href') && this.getAttribute('href') !== '#') {
                            return; // Allow normal link behavior
                        }
                        e.preventDefault();
                        showSection(section);
                    });
                });
            });
        }
        
        function showSection(section) {
            // Hide all sections
            document.getElementById('playerSection').style.display = 'none';
            document.getElementById('librarySection').style.display = 'none';
            document.getElementById('trendingSection').style.display = 'none';
            document.getElementById('newReleasesSection').style.display = 'none';
            
            // Show selected section
            document.getElementById(section + 'Section').style.display = 'block';
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`.nav-link[onclick*="${section}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            currentSection = section;
            
            // Load content for section
            switch(section) {
                case 'library':
                    loadMusicLibrary();
                    break;
                case 'trending':
                    showTrending('daily');
                    break;
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Load trending data
        function loadTrendingData() {
            const songs = getMusicLibrary();
            
            // Simulate trending data based on plays
            trendingData = {
                daily: [...songs].sort(() => Math.random() - 0.5).slice(0, 6),
                weekly: [...songs].sort((a, b) => (b.price || 0) - (a.price || 0)).slice(0, 6),
                monthly: [...songs].sort(() => Math.random() - 0.5).slice(0, 6),
                alltime: songs.slice(0, 6)
            };
            
            // Add trending badges
            trendingData.daily.forEach((song, index) => {
                if (index < 3) {
                    song.trendingBadge = `#${index + 1}`;
                }
            });
        }
        
        function showTrending(period) {
            const container = document.getElementById('trendingSongs');
            const songs = trendingData[period] || [];
            
            // Update active button
            document.querySelectorAll('#trendingSection .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`#trendingSection .filter-btn[onclick*="${period}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            if (songs.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #8A8A8A; grid-column: 1 / -1;">
                        <i class="fas fa-music" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h4>Ch∆∞a c√≥ d·ªØ li·ªáu trending</h4>
                        <p>Quay l·∫°i sau khi c√≥ nhi·ªÅu b√†i h√°t h∆°n</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            songs.forEach((song, index) => {
                const isPurchased = window.hasPurchasedSong ? window.hasPurchasedSong(song.id) : false;
                const isFree = song.type === 'free';
                const canPlay = isFree || isPurchased;
                
                const priceDisplay = isFree ? 
                    '<span style="color: #4CAF50;"><i class="fas fa-unlock"></i> Mi·ªÖn ph√≠</span>' :
                    isPurchased ? 
                    '<span style="color: #6C63FF;"><i class="fas fa-check-circle"></i> ƒê√£ mua</span>' :
                    `<span style="color: #FF6584;">${song.price ? song.price.toLocaleString('vi-VN') + 'ƒë' : '199,000ƒë'}</span>`;
                
                html += `
                    <div class="song-item" onclick="playSong(${song.id})">
                        ${song.trendingBadge ? `<div class="trending-badge">${song.trendingBadge}</div>` : ''}
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                        <img src="${song.thumbnail || 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f'}" 
                             alt="${song.title}" 
                             class="song-item-img">
                        <div class="song-item-info">
                            <div class="song-item-title">
                                ${song.title}
                                ${!canPlay ? '<span style="margin-left: 8px; font-size: 12px; color: #FF6584;"><i class="fas fa-lock"></i></span>' : ''}
                            </div>
                            <div class="song-item-artist">${song.artist}</div>
                            <div class="song-item-meta">
                                <span><i class="fas fa-clock"></i> ${song.duration || '3:30'}</span>
                                <span><i class="fas fa-tag"></i> ${song.genre || 'EDM'}</span>
                                <span><i class="fas fa-fire"></i> ${Math.floor(Math.random() * 1000) + 100} plays</span>
                            </div>
                        </div>
                        <div class="song-item-price">
                            ${priceDisplay}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function showNewReleases(period) {
            const songs = getMusicLibrary();
            
            // Sort by ID (newest first)
            const newReleases = [...songs]
                .sort((a, b) => b.id - a.id)
                .slice(0, 6);
            
            const container = document.getElementById('newReleasesSongs');
            
            if (newReleases.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #8A8A8A; grid-column: 1 / -1;">
                        <i class="fas fa-music" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h4>Ch∆∞a c√≥ b√†i h√°t m·ªõi</h4>
                        <p>Th√™m b√†i h√°t m·ªõi t·ª´ trang admin</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            newReleases.forEach(song => {
                const isPurchased = window.hasPurchasedSong ? window.hasPurchasedSong(song.id) : false;
                const isFree = song.type === 'free';
                const canPlay = isFree || isPurchased;
                
                const priceDisplay = isFree ? 
                    '<span style="color: #4CAF50;"><i class="fas fa-unlock"></i> Mi·ªÖn ph√≠</span>' :
                    isPurchased ? 
                    '<span style="color: #6C63FF;"><i class="fas fa-check-circle"></i> ƒê√£ mua</span>' :
                    `<span style="color: #FF6584;">${song.price ? song.price.toLocaleString('vi-VN') + 'ƒë' : '199,000ƒë'}</span>`;
                
                html += `
                    <div class="song-item" onclick="playSong(${song.id})">
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                        <img src="${song.thumbnail || 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f'}" 
                             alt="${song.title}" 
                             class="song-item-img">
                        <div class="song-item-info">
                            <div class="song-item-title">
                                ${song.title}
                                <span style="margin-left: 8px; font-size: 10px; color: #6C63FF; background: rgba(108, 99, 255, 0.2); padding: 2px 6px; border-radius: 10px;">M·ªöI</span>
                                ${!canPlay ? '<span style="margin-left: 8px; font-size: 12px; color: #FF6584;"><i class="fas fa-lock"></i></span>' : ''}
                            </div>
                            <div class="song-item-artist">${song.artist}</div>
                            <div class="song-item-meta">
                                <span><i class="fas fa-clock"></i> ${song.duration || '3:30'}</span>
                                <span><i class="fas fa-tag"></i> ${song.genre || 'EDM'}</span>
                                <span><i class="fas fa-calendar"></i> M·ªõi c·∫≠p nh·∫≠t</span>
                            </div>
                        </div>
                        <div class="song-item-price">
                            ${priceDisplay}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            // Show new releases section
            document.getElementById('newReleasesSection').style.display = 'block';
        }
        
        // Update user stats
        function updateUserStats() {
            const user = window.getCurrentUser ? window.getCurrentUser() : null;
            const songs = getMusicLibrary();
            
            // Update song count
            document.getElementById('songCount').textContent = songs.length;
            
            // Update favorite count
            if (user && user.favorites) {
                document.getElementById('favoriteCount').textContent = user.favorites.length;
            } else {
                document.getElementById('favoriteCount').textContent = '0';
            }
            
            // Update footer links based on login status
            if (user) {
                document.getElementById('footerLogin').style.display = 'none';
                document.getElementById('footerRegister').style.display = 'none';
            } else {
                document.getElementById('footerLogin').style.display = 'block';
                document.getElementById('footerRegister').style.display = 'block';
            }
        }
        
        // Setup enhanced listeners
        function setupEnhancedListeners() {
            // Like button
            const likeBtn = document.getElementById('likeBtn');
            if (likeBtn) {
                likeBtn.addEventListener('click', function() {
                    const user = window.getCurrentUser ? window.getCurrentUser() : null;
                    
                    if (!user) {
                        showNotification('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m v√†o y√™u th√≠ch!', 'error');
                        return;
                    }
                    
                    if (currentSongId) {
                        const isLiked = user.favorites && user.favorites.includes(currentSongId);
                        
                        if (isLiked) {
                            window.removeFromFavorites(user.id, currentSongId);
                            likeBtn.innerHTML = '<i class="far fa-heart"></i> Y√™u th√≠ch';
                            likeBtn.style.background = '';
                            showNotification('ƒê√£ x√≥a kh·ªèi y√™u th√≠ch');
                        } else {
                            window.addToFavorites(user.id, currentSongId);
                            likeBtn.innerHTML = '<i class="fas fa-heart"></i> ƒê√£ th√≠ch';
                            likeBtn.style.background = '#FF6584';
                            showNotification('ƒê√£ th√™m v√†o y√™u th√≠ch!', 'success');
                        }
                        
                        updateUserStats();
                    }
                });
            }
            
            // Shuffle button
            const shuffleBtn = document.getElementById('shuffleBtn');
            if (shuffleBtn) {
                shuffleBtn.addEventListener('click', function() {
                    const songs = getMusicLibrary();
                    if (songs.length > 0) {
                        const randomSong = songs[Math.floor(Math.random() * songs.length)];
                        playSong(randomSong.id);
                        showNotification('üîÄ ƒêang ph√°t ng·∫´u nhi√™n: ' + randomSong.title);
                    }
                });
            }
            
            // Repeat button
            const repeatBtn = document.getElementById('repeatBtn');
            if (repeatBtn) {
                let repeatMode = 'none'; // none, one, all
                
                repeatBtn.addEventListener('click', function() {
                    const modes = ['none', 'one', 'all'];
                    const icons = ['fa-redo', 'fa-redo-alt', 'fa-sync-alt'];
                    const titles = ['Kh√¥ng l·∫∑p', 'L·∫∑p 1 b√†i', 'L·∫∑p t·∫•t c·∫£'];
                    
                    const currentIndex = modes.indexOf(repeatMode);
                    repeatMode = modes[(currentIndex + 1) % modes.length];
                    
                    repeatBtn.innerHTML = `<i class="fas ${icons[(currentIndex + 1) % modes.length]}"></i>`;
                    repeatBtn.title = titles[(currentIndex + 1) % modes.length];
                    
                    showNotification(`üîÅ Ch·∫ø ƒë·ªô l·∫∑p: ${titles[(currentIndex + 1) % modes.length]}`);
                });
            }
            
            // Volume slider
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeIcon = document.querySelector('.volume-icon');
            
            if (volumeSlider) {
                volumeSlider.addEventListener('input', function() {
                    const audioPlayer = document.getElementById('audioPlayer');
                    if (audioPlayer) {
                        audioPlayer.volume = this.value / 100;
                        
                        // Update volume icon
                        if (volumeIcon) {
                            if (this.value == 0) {
                                volumeIcon.className = 'fas fa-volume-mute volume-icon';
                            } else if (this.value < 50) {
                                volumeIcon.className = 'fas fa-volume-down volume-icon';
                            } else {
                                volumeIcon.className = 'fas fa-volume-up volume-icon';
                            }
                        }
                    }
                });
            }
        }
        
        // Setup mobile menu
        function setupMobileMenu() {
            const menuToggle = document.querySelector('.menu-toggle');
            const navLinks = document.querySelector('.nav-links');
            const navActions = document.querySelector('.nav-actions');
            
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    const isVisible = navLinks.style.display === 'flex';
                    
                    if (isVisible) {
                        navLinks.style.display = 'none';
                        navActions.style.display = 'none';
                    } else {
                        navLinks.style.display = 'flex';
                        navActions.style.display = 'flex';
                        
                        // Mobile-specific styling
                        navLinks.style.flexDirection = 'column';
                        navLinks.style.position = 'absolute';
                        navLinks.style.top = '100%';
                        navLinks.style.left = '0';
                        navLinks.style.width = '100%';
                        navLinks.style.background = 'var(--dark)';
                        navLinks.style.padding = '20px';
                        navLinks.style.borderTop = '1px solid rgba(255,255,255,0.1)';
                        
                        navActions.style.flexDirection = 'column';
                        navActions.style.position = 'absolute';
                        navActions.style.top = 'calc(100% + 200px)';
                        navActions.style.left = '0';
                        navActions.style.width = '100%';
                        navActions.style.background = 'var(--dark)';
                        navActions.style.padding = '20px';
                        navActions.style.gap = '10px';
                    }
                });
            }
            
            // Close menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.navbar') && window.innerWidth <= 992) {
                    navLinks.style.display = 'none';
                    navActions.style.display = 'none';
                }
            });
        }
        
        // Enhanced filter function
        function filterSongs(filter) {
            const songs = getMusicLibrary();
            const user = window.getCurrentUser ? window.getCurrentUser() : null;
            
            let filteredSongs = songs;
            
            switch(filter) {
                case 'free':
                    filteredSongs = songs.filter(song => song.type === 'free');
                    break;
                case 'premium':
                    filteredSongs = songs.filter(song => song.type === 'premium');
                    break;
                case 'favorites':
                    if (user && user.favorites) {
                        filteredSongs = songs.filter(song => user.favorites.includes(song.id));
                    } else {
                        showNotification('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem b√†i h√°t y√™u th√≠ch!', 'error');
                        return;
                    }
                    break;
            }
            
            // Update active button
            document.querySelectorAll('#librarySection .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`#librarySection .filter-btn[onclick*="${filter}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // Show section if not already visible
            showSection('library');
            
            // Update UI (simplified - actual implementation would re-render songs)
            const songsList = document.getElementById('songsList');
            if (songsList) {
                if (filteredSongs.length === 0) {
                    let message = 'Kh√¥ng t√¨m th·∫•y b√†i h√°t';
                    if (filter === 'favorites') {
                        message = 'Ch∆∞a c√≥ b√†i h√°t y√™u th√≠ch';
                    } else if (filter === 'premium') {
                        message = 'Ch∆∞a c√≥ b√†i h√°t premium';
                    } else if (filter === 'free') {
                        message = 'Ch∆∞a c√≥ b√†i h√°t mi·ªÖn ph√≠';
                    }
                    
                    songsList.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #8A8A8A; grid-column: 1 / -1;">
                            <i class="fas fa-${filter === 'favorites' ? 'heart' : 'music'}" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                            <h4>${message}</h4>
                            <p>${filter === 'favorites' ? 'Th√™m b√†i h√°t v√†o y√™u th√≠ch ƒë·ªÉ xem ·ªü ƒë√¢y' : 'Th√™m b√†i h√°t m·ªõi t·ª´ trang admin'}</p>
                        </div>
                    `;
                }
            }
            
            showNotification(`ƒê√£ l·ªçc ${filteredSongs.length} b√†i h√°t ${filter === 'all' ? '' : filter}`);
        }
        
        // Modal functions
        function showUpgradeModal() {
            const user = window.getCurrentUser ? window.getCurrentUser() : null;
            
            if (!user) {
                showNotification('Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ n√¢ng c·∫•p!', 'error');
                setTimeout(() => {
                    window.location.href = './login.html';
                }, 1500);
                return;
            }
            
            if (user.isPremium) {
                showNotification('B·∫°n ƒë√£ l√† th√†nh vi√™n Premium!', 'info');
                return;
            }
            
            const modalHtml = `
                <div id="upgradeModal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.9);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    animation: fadeIn 0.3s ease;
                ">
                    <div style="
                        background: linear-gradient(135deg, #1E1E1E, #121212);
                        padding: 40px;
                        border-radius: 20px;
                        max-width: 600px;
                        width: 90%;
                        border: 2px solid #6C63FF;
                        text-align: center;
                    ">
                        <h2 style="color: #FFD700; margin-bottom: 10px;">
                            <i class="fas fa-crown"></i> N√ÇNG C·∫§P PREMIUM
                        </h2>
                        <p style="color: #B0B0B0; margin-bottom: 30px;">
                            Tr·∫£i nghi·ªám √¢m nh·∫°c kh√¥ng gi·ªõi h·∫°n
                        </p>
                        
                        <div style="
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 20px;
                            margin-bottom: 30px;
                        ">
                            <div style="
                                background: rgba(108, 99, 255, 0.1);
                                padding: 20px;
                                border-radius: 10px;
                                border: 1px solid rgba(108, 99, 255, 0.3);
                            ">
                                <h3 style="color: #6C63FF; margin-top: 0;">üéµ Nghe m·ªçi b√†i h√°t</h3>
                                <p style="color: #B0B0B0; font-size: 14px;">Kh√¥ng gi·ªõi h·∫°n b√†i h√°t Premium</p>
                            </div>
                            
                            <div style="
                                background: rgba(255, 101, 132, 0.1);
                                padding: 20px;
                                border-radius: 10px;
                                border: 1px solid rgba(255, 101, 132, 0.3);
                            ">
                                <h3 style="color: #FF6584; margin-top: 0;">üíæ T·∫£i xu·ªëng kh√¥ng gi·ªõi h·∫°n</h3>
                                <p style="color: #B0B0B0; font-size: 14px;">T·∫£i m·ªçi b√†i h√°t ch·∫•t l∆∞·ª£ng cao</p>
                            </div>
                            
                            <div style="
                                background: rgba(76, 175, 80, 0.1);
                                padding: 20px;
                                border-radius: 10px;
                                border: 1px solid rgba(76, 175, 80, 0.3);
                            ">
                                <h3 style="color: #4CAF50; margin-top: 0;">üéß Kh√¥ng qu·∫£ng c√°o</h3>
                                <p style="color: #B0B0B0; font-size: 14px;">Tr·∫£i nghi·ªám √¢m nh·∫°c li·ªÅn m·∫°ch</p>
                            </div>
                        </div>
                        
                        <div style="
                            background: rgba(255, 215, 0, 0.1);
                            padding: 20px;
                            border-radius: 10px;
                            margin-bottom: 30px;
                            border: 1px solid rgba(255, 215, 0, 0.3);
                        ">
                            <h3 style="color: #FFD700; margin-top: 0; margin-bottom: 10px;">
                                CH·ªà 499,000ƒë/th√°ng
                            </h3>
                            <p style="color: #B0B0B0; font-size: 14px; margin: 0;">
                                H·ªßy b·∫•t c·ª© l√∫c n√†o ‚Ä¢ ƒêƒÉng k√Ω 1 l·∫ßn, h·ªßy khi c·∫ßn
                            </p>
                        </div>
                        
                        <div style="display: flex; gap: 15px; justify-content: center;">
                            <button onclick="closeUpgradeModal()" style="
                                padding: 15px 30px;
                                background: transparent;
                                border: 2px solid #8A8A8A;
                                color: #B0B0B0;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: 600;
                                transition: all 0.3s;
                            " onmouseover="this.style.borderColor='#FF6584'; this.style.color='#FF6584'" 
                               onmouseout="this.style.borderColor='#8A8A8A'; this.style.color='#B0B0B0'">
                                ƒê·ªÉ sau
                            </button>
                            
                            <button onclick="upgradeToPremiumNow()" style="
                                padding: 15px 30px;
                                background: linear-gradient(135deg, #FFD700, #FFA500);
                                border: none;
                                color: #000;
                                border-radius: 10px;
                                cursor: pointer;
                                font-weight: 700;
                                transition: all 0.3s;
                            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(255, 215, 0, 0.3)'"
                               onmouseout="this.style.transform='none'; this.style.boxShadow='none'">
                                <i class="fas fa-bolt"></i> N√ÇNG C·∫§P NGAY
                            </button>
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes fadeIn {
                        from { opacity: 0; }
                        to { opacity: 1; }
                    }
                </style>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }
        
        function closeUpgradeModal() {
            const modal = document.getElementById('upgradeModal');
            if (modal) modal.remove();
        }
        
        function upgradeToPremiumNow() {
            const result = window.upgradeToPremium ? window.upgradeToPremium() : { success: false, message: 'L·ªói h·ªá th·ªëng' };
            
            if (result.success) {
                showNotification('üéâ N√¢ng c·∫•p Premium th√†nh c√¥ng!', 'success');
                updateAuthUI();
                updateUserStats();
                closeUpgradeModal();
            } else {
                showNotification(result.message || 'C√≥ l·ªói x·∫£y ra', 'error');
            }
        }
        
        // Helper functions
        function shareSong() {
            const song = currentSongId ? getSongById(currentSongId) : null;
            const title = song ? song.title : 'VGMEDIA - Nh·∫°c ch·∫•t l∆∞·ª£ng cao';
            const url = window.location.href;
            
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: 'Nghe nh·∫°c ch·∫•t l∆∞·ª£ng cao tr√™n VGMEDIA',
                    url: url
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(url).then(() => {
                    showNotification('üìã ƒê√£ sao ch√©p link chia s·∫ª!', 'success');
                });
            }
        }
        
        function addToPlaylist() {
            showNotification('T√≠nh nƒÉng playlist ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!', 'info');
        }
        
        function viewLyrics() {
            showNotification('T√≠nh nƒÉng l·ªùi b√†i h√°t ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!', 'info');
        }
        
        function showAbout() {
            showNotification('VGMEDIA - N·ªÅn t·∫£ng nh·∫°c ch·∫•t l∆∞·ª£ng cao. Phi√™n b·∫£n 2.0', 'info');
        }
        
        function showTerms() {
            showNotification('ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng ƒëang ƒë∆∞·ª£c c·∫≠p nh·∫≠t...', 'info');
        }
        
        function showPrivacy() {
            showNotification('Ch√≠nh s√°ch b·∫£o m·∫≠t ƒëang ƒë∆∞·ª£c c·∫≠p nh·∫≠t...', 'info');
        }
        
        function showContact() {
            showNotification('Li√™n h·ªá: contact@vgmedia.com', 'info');
        }
        
        function showHelp() {
            showNotification('Tr·ª£ gi√∫p: support@vgmedia.com ho·∫∑c truy c·∫≠p trang FAQ', 'info');
        }
        
        // Notification function
        function showNotification(message, type = 'info') {
            console.log('Notification:', message);
            
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(el => el.remove());
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#FF6584' : '#6C63FF'};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                display: flex;
                align-items: center;
                gap: 10px;
                max-width: 400px;
                font-family: 'Poppins', sans-serif;
            `;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 
                        'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon}" style="font-size: 18px;"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 300);
            }, 3000);
            
            // Add animation styles if not exists
            if (!document.getElementById('notificationStyles')) {
                const style = document.createElement('style');
                style.id = 'notificationStyles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        console.log('üéµ VGMEDIA Enhanced Features Loaded Successfully!');
    </script>
</body>
</html>